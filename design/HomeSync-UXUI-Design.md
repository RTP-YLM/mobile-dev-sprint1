# 🏠 HomeSync - Smart Home Control App
## UX/UI Design Document (NodeMCU DIY Edition)

**Project:** Smart Home Control & Energy Monitoring App  
**Theme:** Dark Mode (Night-friendly)  
**Platform:** iOS & Android  
**Designer:** แอน (UX/UI Designer)  
**Version:** 3.0 - NodeMCU DIY Architecture Update

---

# 🚀 NEW: ONBOARDING FLOW (DIY Setup)

## 1.1 First-Time User Journey

จากเดิมที่ไม่มี onboarding (เพราะ Shelly Plug S ใช้ง่ายอยู่แล้ว)  
ตอนนี้ต้องมี onboarding สำหรับ DIY setup แบบ step-by-step

```
[First Launch]
    │
    ▼
┌─────────────────────────────────────────┐
│  🎉 ยินดีต้อนรับสู่ HomeSync          │
│                                         │
│  ควบคุมบ้านอัจฉริยะแบบ DIY             │
│  ด้วย NodeMCU + HiveMQ                 │
│                                         │
│     ┌─────────────────────────┐        │
│     │    [เริ่มต้นใช้งาน →]    │        │
│     └─────────────────────────┘        │
│                                         │
│  ⚠️ ต้องประกอบฮาร์ดแวร์เองก่อนใช้งาน   │
└─────────────────────────────────────────┘
    │
    ▼
[Onboarding Steps - 5 Steps]
```

### Step 1: Welcome/Intro
```
┌─────────────────────────────────────────┐
│  ━━━━○○○○  ขั้นตอนที่ 1 จาก 5          │
│              ⬅️                         │
├─────────────────────────────────────────┤
│                                         │
│         🛠️                              │
│                                         │
│     ประกอบฮาร์ดแวร์ DIY                │
│                                         │
│  คุณจำเป็นต้องมีอุปกรณ์ต่อไปนี้:        │
│                                         │
│  ✅ NodeMCU ESP8266/ESP32              │
│  ✅ PZEM-004T (หรือ CT Clamp)          │
│  ✅ Relay Module                        │
│  ✅ Jumper Wires                        │
│  ✅ Power Supply (5V/2A)                │
│                                         │
│  [ดูรายการอุปกรณ์แนะนำ →]              │
│                                         │
│     ┌─────────────────────────┐        │
│     │    [ถัดไป →]            │        │
│     └─────────────────────────┘        │
└─────────────────────────────────────────┘
```

### Step 2: Hardware Guide
```
┌─────────────────────────────────────────┐
│  ━━━━━○○○  ขั้นตอนที่ 2 จาก 5          │
│              ⬅️                         │
├─────────────────────────────────────────┤
│                                         │
│     📐 คู่มือการต่อวงจร                │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │     [DIAGRAM/WIRING IMAGE]      │   │
│  │                                 │   │
│  │    NodeMCU    PZEM-004T         │   │
│  │    ───────    ─────────         │   │
│  │    D1  ─────►  RX               │   │
│  │    D2  ─────►  TX               │   │
│  │    5V  ─────►  5V               │   │
│  │    GND ─────►  GND              │   │
│  │                                 │   │
│  │    D5  ─────►  Relay IN         │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  💡 Tip: ตรวจสอบการต่อสายให้ถูกต้อง    │
│                                         │
│  [ดูวิดีโอสอน →]  [ดาวน์โหลด PDF →]   │
│                                         │
│     ┌─────────────────────────┐        │
│     │    [ถัดไป →]            │        │
│     └─────────────────────────┘        │
└─────────────────────────────────────────┘
```

### Step 3: Firmware Setup
```
┌─────────────────────────────────────────┐
│  ━━━━━━━○○  ขั้นตอนที่ 3 จาก 5          │
│              ⬅️                         │
├─────────────────────────────────────────┤
│                                         │
│     💾 อัพโหลดเฟิร์มแวร์               │
│                                         │
│  1. ดาวน์โหลดเฟิร์มแวร์ล่าสุด          │
│     ┌─────────────────────────────┐    │
│     │ 📥 HomeSync-Node-v2.1.bin   │    │
│     │    ขนาด: 512 KB             │    │
│     │    [ดาวน์โหลด]              │    │
│     └─────────────────────────────┘    │
│                                         │
│  2. ใช้ ESP Flash Tool อัพโหลด          │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │  📱 หรือใช้ Web Flash Tool      │   │
│  │                                 │   │
│  │  [🔥 Flash ผ่าน Browser →]      │   │
│  │     (Chrome/Edge เท่านั้น)       │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ✅ เฟิร์มแวร์อัพโหลดสำเร็จ!           │
│                                         │
│     ┌─────────────────────────┐        │
│     │    [ถัดไป →]            │        │
│     └─────────────────────────┘        │
└─────────────────────────────────────────┘
```

### Step 4: WiFi Provisioning (AP Mode)
```
┌─────────────────────────────────────────┐
│  ━━━━━━━━○  ขั้นตอนที่ 4 จาก 5          │
│              ⬅️                         │
├─────────────────────────────────────────┤
│                                         │
│     📶 เชื่อมต่อ WiFi                  │
│                                         │
│  NodeMCU กำลังเปิด Hotspot...          │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │    📡 กรุณาเชื่อมต่อ WiFi       │   │
│  │                                 │   │
│  │    SSID: HomeSync-Node-XXXX     │   │
│  │    Password: homesync123        │   │
│  │                                 │   │
│  │    [คัดลอกรหัสผ่าน]             │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  จากนั้นกลับมาที่แอพ ⬇️                │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │  📶 เลือก WiFi บ้านของคุณ       │   │
│  │                                 │   │
│  │  [Home_WiFi_5G          ▼]     │   │
│  │                                 │   │
│  │  รหัสผ่าน WiFi                 │   │
│  │  [━━━━━━━━━━━━━━━━━━━━━━]       │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│     ┌─────────────────────────┐        │
│     │    [เชื่อมต่อ →]         │        │
│     └─────────────────────────┘        │
└─────────────────────────────────────────┘
```

### Step 5: Sensor Calibration
```
┌─────────────────────────────────────────┐
│  ━━━━━━━━━  ขั้นตอนที่ 5 จาก 5 ✓       │
│              ⬅️                         │
├─────────────────────────────────────────┤
│                                         │
│     ⚡ คาลิเบรทเซ็นเซอร์                │
│                                         │
│  เพื่อความแม่นยำ ให้คาลิเบรทค่าไฟ       │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │  1. ใช้มัลติมิเตอร์วัดแรงดันไฟ   │   │
│  │     ที่บ้านของคุณ                │   │
│  │                                 │   │
│  │  2. ใส่ค่าที่วัดได้:            │   │
│  │     [━━━━━━●━━] 220 V          │   │
│  │                                 │   │
│  │  3. อ่านค่าจาก Sensor:          │   │
│  │     ┌─────────────────────┐    │   │
│  │     │  ⚡ 218 V (จาก Node) │    │   │
│  │     └─────────────────────┘    │   │
│  │                                 │   │
│  │  🔧 Offset: +2V               │   │
│  │                                 │   │
│  │     [คาลิเบรทอัตโนมัติ]          │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ⏭️ [ข้ามไปก่อน]  |  ทำภายหลังได้       │
│                                         │
│     ┌─────────────────────────┐        │
│     │    [เสร็จสิ้น →]         │        │
│     └─────────────────────────┘        │
└─────────────────────────────────────────┘
```

### Onboarding Complete
```
┌─────────────────────────────────────────┐
│                                         │
│         🎉                              │
│                                         │
│     พร้อมใช้งานแล้ว!                    │
│                                         │
│  อุปกรณ์ของคุณถูกเพิ่มแล้ว:             │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │  🔌 NodeMCU-001                 │   │
│  │     ● Online  ⚡ 0W             │   │
│  │     v2.1.0  |  WiFi: -45 dBm    │   │
│  └─────────────────────────────────┘   │
│                                         │
│  💡 คำแนะนำ:                            │
│  • ตรวจสอบ Firmware ให้เป็นเวอร์ชั่นล่าสุด│
│  • คาลิเบรทเซ็นเซอร์ทุก 3 เดือน         │
│                                         │
│     ┌─────────────────────────┐        │
│     │    [ไปที่ Dashboard →]   │        │
│     └─────────────────────────┘        │
│                                         │
└─────────────────────────────────────────┘
```

---

# 📋 2. INFORMATION ARCHITECTURE (Updated)

## 2.1 Updated App Structure

```
📱 HomeSync App
│
├── 🚀 Onboarding (NEW)
│   ├── Welcome/Intro
│   ├── Hardware Guide
│   ├── Firmware Setup
│   ├── WiFi Provisioning
│   └── Sensor Calibration
│
├── 🏠 Dashboard (Home) - UNIFIED CONTROL CENTER
│   ├── Quick Actions Bar
│   ├── Status Overview
│   ├── Active Devices (with live toggle)
│   ├── Scenes Grid
│   ├── Power Usage Summary
│   └── Running Automations Preview
│
├── 📟 Devices - DEVICE CONTROL CENTER
│   ├── Device List (Grid/List/By Room)
│   │   └── NEW: Technical Info Cards
│   ├── Quick Controls
│   ├── Bulk Actions
│   ├── Search/Filter
│   ├── Add New Device
│   │   └── NEW: DIY Setup Flow
│   └── 🔄 Device Detail - FULL CONTROL PANEL
│       ├── Overview (Power + Control)
│       ├── Metrics (Graphs)
│       ├── Settings (NEW - Node Configuration)
│       │   ├── Sensor Calibration
│       │   ├── GPIO Pin Assignments
│       │   ├── Reporting Interval
│       │   └── WiFi Settings
│       ├── Diagnostics (NEW - Debug Info)
│       │   ├── Connection Status
│       │   ├── Last Seen Timestamp
│       │   ├── Error Logs
│       │   └── Restart History
│       ├── OTA Update (NEW)
│       ├── Schedule Widget
│       ├── Automation Rules
│       └── Device Info
│
├── 📅 Schedule - SCHEDULING CENTER
├── ⚡ Automation - AUTOMATION CENTER
├── 🎭 Scenes - SCENE CENTER
├── 📊 Analytics - HISTORY & INSIGHTS
│
└── ⚙️ Settings
    ├── Account
    ├── Default Behaviors
    ├── Automation Preferences
    ├── Scene Customization
    ├── Notification Settings
    ├── Energy Rate Configuration
    ├── Device Management
    │   ├── Manage Devices
    │   ├── MQTT Connection Settings
    │   └── Firmware Repository (NEW)
    └── Help & Support
        ├── Troubleshooting Wizard (NEW)
        ├── DIY Guides
        └── Contact Support
```

---

# 🖼️ 3. WIREFRAMES (Updated for DIY)

## 3.1 Device List Screen (Updated with Technical Info)

```
┌─────────────────────────────────────────┐
│  🔍 Search devices...    ☐ [Select]  ┇  │
├─────────────────────────────────────────┤
│  [All] [Online] [Offline] [Update] ⚠️   │
├─────────────────────────────────────────┤
│                                         │
│  🔌 SMART PLUGS (2 devices)             │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │ 🔌  Air Conditioner Plug        │   │
│  │ ┌─────────────────────────────┐ │   │
│  │ │ ● Online  ⚡1,200W  [━━●]   │ │   │
│  │ │                             │ │   │
│  │ │ 🆔 Node-A1C3   📶 -42dBm   │ │   │
│  │ │ 📦 v2.1.0    ⏱️ 3d 12h      │ │   │
│  │ │                             │ │   │
│  │ │ [📊] [⚙️] [🔄 OTA] [↻]      │ │   │
│  │ └─────────────────────────────┘ │   │
│  │                                 │   │
│  │ ℹ️ Hold for advanced options    │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │ 🔌  Water Heater Plug           │   │
│  │ ┌─────────────────────────────┐ │   │
│  │ │ ● Online  ⚡0W     [●━━]   │ │   │
│  │ │                             │ │   │
│  │ │ 🆔 Node-B2D4   📶 -58dBm   │ │   │
│  │ │ ⚠️ v2.0.1 ← Update available│ │   │
│  │ │ ⏱️ 15d 4h                   │ │   │
│  │ │                             │ │   │
│  │ │ [📊] [⚙️] [⬇️ Update] [↻]   │ │   │
│  │ └─────────────────────────────┘ │   │
│  │                                 │   │
│  │ ⚠️ Weak signal - Check WiFi     │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │ 🔌  Bedroom Plug                │   │
│  │ ┌─────────────────────────────┐ │   │
│  │ │ 🔴 Offline  ⚡--     [━━━]  │ │   │
│  │ │                             │ │   │
│  │ │ 🆔 Node-C3E5                │ │   │
│  │ │ ❌ Last seen 2 hours ago    │ │   │
│  │ │                             │ │   │
│  │ │ [? Help] [🔄 Retry]         │ │   │
│  │ └─────────────────────────────┘ │   │
│  │                                 │   │
│  │ 🔴 WiFi disconnected?           │   │
│  └─────────────────────────────────┘   │
│                                         │
│         [+]  Add New Device             │
│                                         │
│         [🏠] [📟] [📅] [⚡] [🎭]        │
└─────────────────────────────────────────┘
```

### Device Card Component Details (NEW)

**Technical Info Section (Always Visible):**
```
┌─────────────────────────────────┐
│ 🆔 Node ID       MAC/Custom ID  │
│ 📶 Signal        WiFi RSSI dBm  │
│ 📦 Firmware      Version + Status│
│ ⏱️ Uptime        Days:Hours:Mins│
│ 🔌 Sensor Type   PZEM/CT Clamp  │
└─────────────────────────────────┘
```

**Status Indicators:**
```
Signal Strength (RSSI):
  📶 -30 to -50 dBm  ● Green   (Excellent)
  📶 -50 to -65 dBm  ● Yellow  (Good)
  📶 -65 to -75 dBm  ● Orange  (Fair)
  📶 -75+ dBm        ● Red     (Poor)

Firmware Status:
  ● v2.1.0          Green     (Latest)
  ⚠️ v2.0.1         Orange    (Update available)
  ❌ v1.9.0          Red       (Critical update)

Uptime:
  ● < 1 day         Yellow    (Recently restarted)
  ● 1-7 days        Green     (Normal)
  ● > 30 days       Blue      (Excellent stability)
```

**Quick Action Buttons:**
```
[📊] - View Metrics/Graphs
[⚙️] - Open Settings Tab
[🔄/⬇️] - OTA Update (icon changes if available)
[↻] - Restart Node
```

---

## 3.2 Device Detail Screen (Updated with Tabs)

```
┌─────────────────────────────────────────┐
│  ← Back              🔌 AC Plug         │
│              🆔 Node-A1C3              │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │        ⚡ 1,200 W               │   │
│  │                                 │   │
│  │      ████████████████████       │   │
│  │      █   ◉ POWER ◉      █       │   │
│  │      ████████████████████       │   │
│  │                                 │   │
│  │        [━━━●━━━] ON             │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ● Online  •  ⏰ Schedule  •  ⚡ Auto   │
│  📶 -42 dBm  •  📦 v2.1.0  •  ⏱️ 3d    │
│                                         │
├─────────────────────────────────────────┤
│  [ภาพรวม] [📈 Metrics] [⚙️ Settings] [🔧 Debug] │
├─────────────────────────────────────────┤
│                                         │
│  📈 POWER CONSUMPTION                   │
│  ┌─────────────────────────────────┐   │
│  │  Real-time Graph                │   │
│  │  ▁▃▅▇████▇▅▃▁                  │   │
│  │  1m  5m  15m  30m  1h          │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ⏰ SCHEDULES (2 active)                │
│  ...                                     │
│                                         │
│  ⚡ AUTOMATION RULES (1 active)         │
│  ...                                     │
│                                         │
└─────────────────────────────────────────┘
```

### Settings Tab (NEW)

```
┌─────────────────────────────────────────┐
│  [ภาพรวม] [📈 Metrics] [⚙️ Settings] [🔧 Debug] │
├─────────────────────────────────────────┤
│                                         │
│  ⚡ SENSOR CALIBRATION                  │
│  ┌─────────────────────────────────┐   │
│  │ 🔌 Voltage Calibration          │   │
│  │    Offset: [━━●━━━━━] +2.0V    │   │
│  │    Multiplier: 1.00             │   │
│  │    [Calibrate Now →]            │   │
│  │                                 │   │
│  │ ⚡ Current Calibration          │   │
│  │    Offset: [━━━━●━━━] +0.05A   │   │
│  │    Multiplier: 0.98             │   │
│  │    [Calibrate Now →]            │   │
│  │                                 │   │
│  │ 🔄 Last calibrated: 5 days ago  │   │
│  └─────────────────────────────────┘   │
│                                         │
│  📊 REPORTING CONFIGURATION             │
│  ┌─────────────────────────────────┐   │
│  │ Data Interval                   │   │
│  │ [○ 1s] [● 5s] [○ 10s] [○ 30s]  │   │
│  │                                 │   │
│  │ Batch Size: [━━●━━━━━━] 10     │   │
│  │ (Send every 10 readings)        │   │
│  └─────────────────────────────────┘   │
│                                         │
│  🔌 GPIO PIN ASSIGNMENTS                │
│  ┌─────────────────────────────────┐   │
│  │ Sensor TX Pin:  [D1     ▼]     │   │
│  │ Sensor RX Pin:  [D2     ▼]     │   │
│  │ Relay Pin:      [D5     ▼]     │   │
│  │ LED Indicator:  [D4     ▼]     │   │
│  │                                 │   │
│  │ ⚠️ Changing pins requires restart│   │
│  └─────────────────────────────────┘   │
│                                         │
│  📶 WIFI SETTINGS                       │
│  ┌─────────────────────────────────┐   │
│  │ Current: Home_WiFi_5G           │   │
│  │ Signal: -42 dBm (Excellent)     │   │
│  │                                 │   │
│  │ [Change Network →]              │   │
│  │ [Set Static IP →]               │   │
│  │ [WiFi Power Save: ● On]         │   │
│  └─────────────────────────────────┘   │
│                                         │
│  🔄 FIRMWARE UPDATE                     │
│  ┌─────────────────────────────────┐   │
│  │ Current: v2.1.0 (Latest)        │   │
│  │                                 │   │
│  │ [Check for Updates]             │   │
│  │ [Advanced OTA Options →]        │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

### Diagnostics Tab (NEW)

```
┌─────────────────────────────────────────┐
│  [ภาพรวม] [📈 Metrics] [⚙️ Settings] [🔧 Debug] │
├─────────────────────────────────────────┤
│                                         │
│  🔌 CONNECTION STATUS                   │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │  WiFi        ● Connected        │   │
│  │  IP          192.168.1.45       │   │
│  │  RSSI        -42 dBm            │   │
│  │                                 │   │
│  │  MQTT        ● Connected        │   │
│  │  Broker      hivemq.homesync.io │   │
│  │  Last Ping   2s ago             │   │
│  │                                 │   │
│  │  Sensor      ● Active           │   │
│  │  Reads/min   12                 │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ⏱️ DEVICE LIFECYCLE                    │
│  ┌─────────────────────────────────┐   │
│  │ First Seen:  Jan 15, 2025       │   │
│  │ Last Seen:   2 seconds ago      │   │
│  │ Uptime:      3 days 12 hours    │   │
│  │                                 │   │
│  │ Restart History:                │   │
│  │ • Today 08:30 - OTA Update      │   │
│  │ • Jan 18 22:00 - Power cycle    │   │
│  │ • Jan 15 14:20 - First boot     │   │
│  └─────────────────────────────────┘   │
│                                         │
│  🐛 ERROR LOGS                          │
│  ┌─────────────────────────────────┐   │
│  │ [Clear] [Export] [Auto-refresh ●]│   │
│  ├─────────────────────────────────┤   │
│  │ 2025-02-06 18:30:15 [WARN]      │   │
│  │ WiFi reconnect #2               │   │
│  │                                 │   │
│  │ 2025-02-06 14:22:01 [INFO]      │   │
│  │ OTA update completed v2.1.0     │   │
│  │                                 │   │
│  │ 2025-02-05 09:15:33 [ERROR]     │   │
│  │ Sensor read timeout (recovered) │   │
│  │                                 │   │
│  │ [View Full Logs →]              │   │
│  └─────────────────────────────────┘   │
│                                         │
│  🔧 QUICK ACTIONS                       │
│  ┌─────────────────────────────────┐   │
│  │ [🔄 Restart Node] [📤 Factory   │   │
│  │ Reset] [💾 Backup Config]       │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

---

## 3.3 OTA Update Screen (NEW)

```
┌─────────────────────────────────────────┐
│  ⬅ OTA Firmware Update                  │
├─────────────────────────────────────────┤
│                                         │
│  📦 CURRENT VERSION                     │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │     📦 v2.1.0                   │   │
│  │     Build: 20250201             │   │
│  │                                 │   │
│  │     ✓ คุณกำลังใช้เวอร์ชั่นล่าสุด   │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━   │
│                                         │
│  🔄 CHECK FOR UPDATES                   │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │  [🔄 Check Now]                 │   │
│  │                                 │   │
│  │  Last checked: 2 hours ago      │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
```

### Update Available State
```
┌─────────────────────────────────────────┐
│  ⬅ OTA Firmware Update                  │
├─────────────────────────────────────────┤
│                                         │
│  📦 UPDATE AVAILABLE!                   │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │  📦 v2.2.0  ← New!             │   │
│  │  ขนาด: 524 KB                   │   │
│  │                                 │   │
│  │  Release Notes:                 │   │
│  │  • ปรับปรุงความเสถียร WiFi      │   │
│  │  • แก้ไขบั๊กการอ่านค่า PZEM      │   │
│  │  • เพิ่มการรองรับ CT Clamp       │   │
│  │                                 │   │
│  │  [ดูทั้งหมด →]                   │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  🔄 จาก v2.1.0 → v2.2.0                 │
│                                         │
│  ⚠️ คำเตือน:                            │
│  • ห้ามปิดแอพหรือปิดไฟระหว่างอัพเดท    │
│  • ใช้เวลาประมาณ 2-3 นาที              │
│  • Node จะรีสตาร์ทอัตโนมัติ             │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │      [⬇️ ดาวน์โหลด & ติดตั้ง]     │   │
│  └─────────────────────────────────┘   │
│                                         │
│  [⏰ ติดตั้งภายหลัง]                     │
│                                         │
└─────────────────────────────────────────┘
```

### Downloading State
```
┌─────────────────────────────────────────┐
│  ⬅ OTA Firmware Update                  │
├─────────────────────────────────────────┤
│                                         │
│  ⬇️ กำลังดาวน์โหลด...                    │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │     ⬇️ 65%                     │   │
│  │                                 │   │
│  │  [████████████░░░░░░]          │   │
│  │                                 │   │
│  │  340 KB / 524 KB               │   │
│  │  45 KB/s                       │   │
│  │                                 │   │
│  │  เวลาที่เหลือ: ~4 วินาที        │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  📋 ขั้นตอน:                             │
│  ● ดาวน์โหลดเฟิร์มแวร์ ✓               │
│  ○ ตรวจสอบความถูกต้อง                  │
│  ○ อัพโหลดไปยัง Node                    │
│  ○ รีสตาร์ท Node                        │
│                                         │
│  [✕ ยกเลิก]                             │
│                                         │
└─────────────────────────────────────────┘
```

### Flashing State
```
┌─────────────────────────────────────────┐
│  ⬅ OTA Firmware Update                  │
├─────────────────────────────────────────┤
│                                         │
│  🔥 กำลังติดตั้งลง Node...               │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │     🔥 80%                     │   │
│  │                                 │   │
│  │  [████████████████░░]          │   │
│  │                                 │   │
│  │  กำลังเขียน Flash memory...    │   │
│  │                                 │   │
│  │  ⚠️ ห้ามปิดแอพในขั้นตอนนี้      │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  📋 ขั้นตอน:                             │
│  ● ดาวน์โหลดเฟิร์มแวร์ ✓               │
│  ● ตรวจสอบความถูกต้อง ✓                │
│  ● อัพโหลดไปยัง Node ✓                  │
│  🔥 รีสตาร์ท Node...                    │
│                                         │
│  ⏱️ รอสักครู่...                        │
│                                         │
└─────────────────────────────────────────┘
```

### Success State
```
┌─────────────────────────────────────────┐
│  ⬅ OTA Firmware Update                  │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │         ✅                     │   │
│  │                                 │   │
│  │    อัพเดทสำเร็จ!               │   │
│  │                                 │   │
│  │  📦 v2.1.0 → v2.2.0            │   │
│  │                                 │   │
│  │  Node รีสตาร์ทเรียบร้อยแล้ว      │   │
│  │  ✅ Online  •  📶 -45 dBm      │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  📋 บันทึกการอัพเดท:                      │
│  • วันที่: Feb 6, 2025 18:30            │
│  • ใช้เวลา: 3 นาที 12 วินาที            │
│  • สถานะ: สำเร็จ                        │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │    [กลับไปที่อุปกรณ์ →]          │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

### Failed State (with Rollback)
```
┌─────────────────────────────────────────┐
│  ⬅ OTA Firmware Update                  │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │         ❌                     │   │
│  │                                 │   │
│  │    อัพเดทล้มเหลว               │   │
│  │                                 │   │
│  │  สาเหตุ: Timeout ขณะ Flash     │   │
│  │                                 │   │
│  │  🔄 Node กลับไปใช้ v2.1.0 แล้ว │   │
│  │  ✅ Online  •  📶 -42 dBm      │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  🔧 แนะนำให้ลอง:                         │
│  • ตรวจสอบสัญญาณ WiFi                   │
│  • รีสตาร์ท Node แล้วลองใหม่             │
│  • ดาวน์โหลดเฟิร์มแวร์ใหม่               │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │  [🔄 ลองใหม่]  [🆘 ขอความช่วยเหลือ] │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

---

## 3.4 Calibration Screen (NEW)

```
┌─────────────────────────────────────────┐
│  ⬅ Sensor Calibration                   │
│            🔌 Node-A1C3                 │
├─────────────────────────────────────────┤
│                                         │
│  📋 ทำไมต้องคาลิเบรท?                    │
│  ┌─────────────────────────────────┐   │
│  │ 💡 เซ็นเซอร์ DIY อาจมีค่าคลาดเคลื่อน │   │
│  │    คาลิเบรทเพื่อให้ค่าตรงกับมาตรฐาน  │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ⚡ VOLTAGE CALIBRATION                 │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │  1. วัดแรงดันไฟด้วยมัลติมิเตอร์ │   │
│  │                                 │   │
│  │  2. ใส่ค่าที่วัดได้จริง:        │   │
│  │     ┌─────────────────────┐    │   │
│  │     │ 220.0            V  │    │   │
│  │     └─────────────────────┘    │   │
│  │                                 │   │
│  │  3. ค่าที่ Sensor อ่านได้:      │   │
│  │     ┌─────────────────────┐    │   │
│  │     │ 218.5            V  │    │   │
│  │     └─────────────────────┘    │   │
│  │        (อัพเดทแบบเรียลไทม์)      │   │
│  │                                 │   │
│  │  ─────────────────────────────  │   │
│  │                                 │   │
│  │  🔧 คำนวณอัตโนมัติ:              │   │
│  │     Offset: +1.5 V              │   │
│  │     Multiplier: 1.000           │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ⚡ CURRENT CALIBRATION                 │
│  ┌─────────────────────────────────┐   │
│  │ (Similar to Voltage section)    │   │
│  │ ...                             │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │    [💾 บันทึกการคาลิเบรท]          │   │
│  └─────────────────────────────────┘   │
│                                         │
│  🔄 คาลิเบรทล่าสุด: 5 วันที่แล้ว          │
│                                         │
└─────────────────────────────────────────┘
```

### Calibration Wizard Flow
```
┌─────────────────────────────────────────┐
│  คู่มือคาลิเบรทแบบ Step-by-Step         │
├─────────────────────────────────────────┤
│                                         │
│  ━━━━○○  ขั้นตอนที่ 1 จาก 3            │
│                                         │
│  📏 เตรียมอุปกรณ์                       │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │    [รูปมัลติมิเตอร์]             │   │
│  │                                 │   │
│  │  ต้องการ:                       │   │
│  │  ✅ มัลติมิเตอร์ดิจิตอล          │   │
│  │  ✅ สายวัดไฟ AC                 │   │
│  │                                 │   │
│  │  💡 วัดที่ขาออกของปลั๊กที่ต่อ Node│   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│     ┌─────────────────────────┐        │
│     │    [ถัดไป →]            │        │
│     └─────────────────────────┘        │
│                                         │
└─────────────────────────────────────────┘
```

---

## 3.5 Error States & Recovery Flows (NEW)

### Device Offline - WiFi Disconnected
```
┌─────────────────────────────────────────┐
│  🔌 Node-A1C3                           │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │          🔴                    │   │
│  │                                 │   │
│  │     อุปกรณ์ออฟไลน์             │   │
│  │                                 │   │
│  │  ❌ ไม่พบ Node-A1C3             │   │
│  │                                 │   │
│  │  ไม่ได้เชื่อมต่อมา 2 ชั่วโมง    │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  🔍 ตรวจสอบสาเหตุที่เป็นไปได้:           │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │ ⚠️ WiFi Disconnected?           │   │
│  │    ตรวจสอบ Router และสัญญาณ    │   │
│  │    [วิธีแก้ไข →]                 │   │
│  ├─────────────────────────────────┤   │
│  │ ⚠️ Power Issue?                 │   │
│  │    ตรวจสอบ Adapter และสายไฟ    │   │
│  │    [วิธีแก้ไข →]                 │   │
│  ├─────────────────────────────────┤   │
│  │ ⚠️ Firmware Crash?              │   │
│  │    อาจต้องรีสตาร์ทหรือ Reflash  │   │
│  │    [Recovery Mode →]            │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │  [🔄 ลองเชื่อมต่อใหม่]            │   │
│  │  [📶 ตั้งค่า WiFi ใหม่]           │   │
│  └─────────────────────────────────┘   │
│                                         │
│  🆘 ยังไม่ได้? [ติดต่อ Support]         │
│                                         │
└─────────────────────────────────────────┘
```

### Troubleshooting Wizard
```
┌─────────────────────────────────────────┐
│  🧰 Troubleshooting Wizard              │
├─────────────────────────────────────────┤
│                                         │
│  🔍 กำลังวิเคราะห์ปัญหา...               │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │  1. ตรวจสอบ WiFi Router    ✓   │   │
│  │  2. ตรวจสอบ MQTT Broker    ✓   │   │
│  │  3. Ping Node device       ❌   │   │
│  │  4. ตรวจสอบสัญญาณ WiFi    ⏳   │   │
│  │                                 │   │
│  │     [████████████░░░░░░] 75%   │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ─────────────────────────────────     │
│                                         │
│  🔴 พบปัญหา: WiFi Signal อ่อนเกินไป     │
│                                         │
│  📶 สัญญาณปัจจุบัน: -82 dBm (Poor)      │
│                                         │
│  💡 แนะนำ:                              │
│  • ย้าย Node ใกล้ Router ขึ้น           │
│  • ใช้ WiFi Extender                    │
│  • ตั้งค่า WiFi Power Save เป็น Off     │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │  [ไปที่ WiFi Settings →]        │   │
│  │  [🔧 แก้ไข WiFi Power Save]      │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

### MQTT Connection Lost
```
┌─────────────────────────────────────────┐
│  ⚠️ MQTT Connection Issue               │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │    📶 WiFi: ● Connected         │   │
│  │    🌐 MQTT: 🔴 Disconnected     │   │
│  │                                 │   │
│  │    ❌ ไม่สามารถเชื่อมต่อ          │   │
│  │       hivemq.homesync.io        │   │
│  │                                 │   │
│  │    Last error: Connection timeout│   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  🔧 ลองแก้ไข:                           │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │ 1. รีสตาร์ท Node                 │   │
│  │    [🔄 Restart Now]             │   │
│  │                                 │   │
│  │ 2. ตรวจสอบ MQTT Settings        │   │
│  │    [⚙️ Check Settings →]        │   │
│  │                                 │   │
│  │ 3. ตรวจสอบ Firewall/Router      │   │
│  │    [ดูคำแนะนำ →]                │   │
│  └─────────────────────────────────┘   │
│                                         │
│  [🔄 Retry Connection]                  │
│                                         │
└─────────────────────────────────────────┘
```

### Sensor Reading Error
```
┌─────────────────────────────────────────┐
│  ⚠️ Sensor Error                        │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │         ⚠️                     │   │
│  │                                 │   │
│  │  เซ็นเซอร์อ่านค่าไม่ได้         │   │
│  │                                 │   │
│  │  ค่าล่าสุด: NaN (Not a Number) │   │
│  │  เวลา: 2 นาทีที่แล้ว            │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│  🔍 สาเหตุที่เป็นไปได้:                   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │ ❌ สายเซ็นเซอร์หลุด/หลวม       │   │
│  │    [วิธีตรวจสอบ →]              │   │
│  ├─────────────────────────────────┤   │
│  │ ❌ เซ็นเซอร์เสียหาย             │   │
│  │    [วิธีทดสอบเซ็นเซอร์ →]       │   │
│  ├─────────────────────────────────┤   │
│  │ ❌ GPIO Pin ตั้งค่าผิด          │   │
│  │    [แก้ไข GPIO Settings →]     │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │  [🔧 เปิด Diagnostics]           │   │
│  │  [🔄 รีสตาร์ทเซ็นเซอร์]          │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

### Firmware Outdated Warning
```
┌─────────────────────────────────────────┐
│  📟 Devices                             │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │  ⚠️ Firmware Updates Available  │   │
│  │                                 │   │
│  │  2 อุปกรณ์ต้องการอัพเดท          │   │
│  │                                 │   │
│  │  • Node-B2D4: v2.0.1 → v2.2.0  │   │
│  │  • Node-C3E5: v2.0.0 → v2.2.0  │   │
│  │                                 │   │
│  │  [อัพเดททั้งหมด] [ดูรายละเอียด →] │   │
│  └─────────────────────────────────┘   │
│                                         │
│  🔌 SMART PLUGS                         │
│  ...                                    │
│                                         │
└─────────────────────────────────────────┘
```

### Calibration Needed Alert
```
┌─────────────────────────────────────────┐
│  🔌 Node-A1C3                           │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │  ⚠️ Calibration Recommended     │   │
│  │                                 │   │
│  │  ไม่ได้คาลิเบรทมา 3 เดือนแล้ว   │   │
│  │                                 │   │
│  │  ค่าอ่านอาจคลาดเคลื่อน:          │   │
│  │  • Voltage: ±5%                 │   │
│  │  • Current: ±8%                 │   │
│  │                                 │   │
│  │  💡 แนะนำให้คาลิเบรททุก 3 เดือน  │   │
│  │                                 │   │
│  │  [คาลิเบรทตอนนี้ →] [⏰ ภายหลัง]  │   │
│  └─────────────────────────────────┘   │
│                                         │
```

---

# 🎨 4. DESIGN SYSTEM (Updated)

## 4.1 Color Palette (Additions for DIY)

### NEW: Technical Info Colors
```
Technical Blue              #4A90D9  - Node ID, technical labels
RSSI Good                   #00E676  - Signal -30 to -50 dBm
RSSI Fair                   #FFD600  - Signal -50 to -65 dBm
RSSI Poor                   #FF9100  - Signal -65 to -75 dBm
RSSI Critical               #FF5252  - Signal -75+ dBm

Firmware Current            #00E676  - Up to date
Firmware Update             #FF9F43  - Update available
Firmware Critical           #FF5252  - Critical update needed

Calibration Good            #00E676  - Calibrated recently
Calibration Warning         #FFD600  - > 1 month
Calibration Critical        #FF5252  - > 3 months
```

### NEW: Status Glow Effects
```
Online Glow:     box-shadow: 0 0 8px rgba(0, 230, 118, 0.4)
Offline Glow:    box-shadow: 0 0 8px rgba(255, 82, 82, 0.4)
Update Glow:     box-shadow: 0 0 8px rgba(255, 159, 67, 0.4)
Warning Glow:    box-shadow: 0 0 8px rgba(255, 214, 0, 0.4)
```

## 4.2 Component Library (NEW Components)

### Technical Info Card
```
Background:    Background Secondary
Border:        1px solid Border Default
Border Radius: 12px
Padding:       12px

Layout:
┌─────────────────────────────────┐
│ 🆔 Node-A1C3   📶 -42 dBm      │
│ 📦 v2.1.0      ⏱️ 3d 12h        │
│ 🔌 PZEM-004T                    │
└─────────────────────────────────┘

Icon Size:     14px
Label Color:   Text Tertiary
Value Color:   Text Secondary
Spacing:       8px between rows
```

### Progress Indicator (for OTA)
```
Background:    Background Tertiary
Fill:          Gradient (Electric Blue → Electric Blue Light)
Height:        8px
Border Radius: 4px

Animation:     Indeterminate shimmer when waiting
               Determinate fill with pulse glow when active

Label:         Percentage below (Caption, Electric Blue)
               Status text (Micro, Text Tertiary)
```

### Step Indicator (Onboarding/Calibration)
```
Completed:     ● Green with checkmark
Active:        ● Electric Blue with pulse
Pending:       ○ Gray outline

Connector:     Line between steps
Completed:     Green solid line
Pending:       Gray dashed line

Label:         Caption below each step
               Active: Text Primary
               Others: Text Tertiary
```

### Error State Card
```
Background:    Surface Primary
Left Border:   4px solid Error Red
Border Radius: 12px
Padding:       16px

Header:
- Icon:        Warning ⚠️ 24px
- Title:       H4, Text Primary
- Color:       Error Red

Content:
- Description: Body, Text Secondary
- Actions:     Primary button + Secondary button

Icon Animation: Subtle pulse 2s infinite
```

### Recovery Action Button
```
Primary:
Background:    Electric Blue
Text:          Inverse
Icon:          Action-specific (🔄, 🔧, etc.)

Secondary:
Background:    Transparent
Border:        1px solid Border Default
Text:          Text Secondary

Danger:
Background:    Error Red with 10% opacity
Border:        1px solid Error Red
Text:          Error Red
```

## 4.3 Typography (Additions)

```
Technical Label             12px / 16px   Medium     (Node ID, MAC)
Technical Value             13px / 18px   Regular    (Values, readings)
Status Badge                10px / 12px   Semibold   (Online, Offline)
Progress Percentage         24px / 32px   Bold       (OTA progress)
Step Title                  16px / 24px   Semibold   (Onboarding)
Step Description            14px / 20px   Regular    (Explanations)
Error Title                 18px / 24px   Semibold   (Error states)
Error Description           14px / 20px   Regular    (Recovery steps)
```

---

# 🔄 5. USER FLOWS (NEW)

## 5.1 DIY Setup Flow (Complete)

```
[แอพติดตั้งครั้งแรก / Add New Device]
    │
    ▼
[Onboarding Welcome]
    │
    ├── มีอุปกรณ์แล้ว? → [Skip to WiFi Provisioning]
    └── ยังไม่มี? → ดู Hardware Guide
    │
    ▼
[Hardware Guide]
    │
    ├── ดู Wiring Diagram
    ├── ดู Video Tutorial
    └── ดาวน์โหลด PDF
    │
    ▼
[Firmware Setup]
    │
    ├── ดาวน์โหลด Firmware .bin
    ├── Web Flash Tool (แนะนำ)
    └── ESP Flash Tool (advanced)
    │
    ▼
[WiFi Provisioning]
    │
    ├── เชื่อมต่อกับ Node AP
    ├── ส่ง WiFi Credentials
    └── รอ Node เชื่อมต่อ WiFi
    │
    ▼
[Sensor Calibration]
    │
    ├── ขั้นตอนที่ 1: เตรียม Multimeter
    ├── ขั้นตอนที่ 2: วัด Voltage
    ├── ขั้นตอนที่ 3: วัด Current
    └── คำนวณ Offset/Multiplier
    │
    ▼
[Setup Complete]
    │
    └── [ไปที่ Dashboard]
```

## 5.2 OTA Update Flow

```
[Device Detail → OTA Update]
    │
    ▼
[Check Current Version]
    │
    ▼
[Check for Updates]
    │
    ├── No update → [Show "Up to date"]
    │
    └── Update available
        │
        ▼
    [Download Firmware]
        │
        ├── Progress indicator
        ├── Cancel available
        └── Auto-retry on fail
        │
        ▼
    [Verify Checksum]
        │
        └── ❌ Fail → [Retry / Download again]
        │
        ▼
    [Upload to Node]
        │
        ├── Progress indicator
        ├── ⚠️ Warning: Don't close app
        └── Connection monitoring
        │
        ▼
    [Flash & Restart]
        │
        ├── Auto-flash on Node
        ├── Node auto-restart
        └── App waits for reconnect
        │
        ▼
    [Verify Update]
        │
        ├── ✅ Success → [Show new version]
        │
        └── ❌ Fail → [Auto-rollback]
            │
            └── [Show error + recovery options]
```

## 5.3 Calibration Flow

```
[Device Detail → Settings → Calibrate]
    │
    ▼
[Calibration Intro]
    │
    ├── Why calibrate?
    ├── How often?
    └── Required tools
    │
    ▼
[Voltage Calibration]
    │
    ├── Step 1: Measure with multimeter
    ├── Step 2: Enter actual voltage
    ├── Step 3: Read sensor value
    └── Auto-calculate offset
    │
    ▼
[Current Calibration]
    │
    ├── Similar 3-step process
    └── May need load (heater, etc.)
    │
    ▼
[Review & Save]
    │
    ├── Preview new calibration
    ├── Compare before/after
    └── [Save] or [Adjust]
    │
    ▼
[Apply to Node]
    │
    ├── Send config to Node
    ├── Verify applied
    └── Start using new values
```

## 5.4 Error Recovery Flows

### WiFi Disconnected Recovery
```
[Device shows Offline]
    │
    ▼
[Tap device → Troubleshoot]
    │
    ▼
[Diagnostic Check]
    │
    ├── Ping Router    ✓/✗
    ├── Ping Node      ✓/✗
    ├── Check MQTT     ✓/✗
    └── WiFi Signal    dBm
    │
    ▼
[Identify Issue]
    │
    ├── WiFi Signal weak
    │   └── [Suggest: Move closer / Extender]
    │
    ├── WiFi credentials wrong
    │   └── [Re-provision WiFi]
    │
    ├── Node powered off
    │   └── [Check power adapter]
    │
    └── Unknown
        └── [Advanced diagnostics]
```

### Factory Reset Flow
```
[Device Detail → Diagnostics]
    │
    ▼
[Factory Reset Option]
    │
    ├── ⚠️ Warning dialog
    ├── Confirm: Type "RESET"
    └── List what will be erased:
        - WiFi settings
        - Calibration values
        - GPIO config
        - MQTT settings
    │
    ▼
[Reset Confirmed]
    │
    ├── Send reset command
    ├── Node erases flash
    └── Auto-restarts in AP mode
    │
    ▼
[Re-setup Required]
    │
    └── [Start WiFi Provisioning]
```

---

# 🎯 6. UX PRINCIPLES FOR DIY

## 6.1 Technical vs Non-Technical Users

### Progressive Disclosure
```
Level 1 - Basic User:
- On/Off toggle
- Power reading
- Online/Offline status
- Simple error messages

Level 2 - Curious User:
- Tap to expand technical info
- Signal strength (simple bars)
- Firmware version
- Last seen time

Level 3 - Technical User:
- Full diagnostics tab
- Raw sensor values
- MQTT connection details
- GPIO configuration
- Log export
```

### Jargon Buster
```
Technical Term     → User-Friendly Label
─────────────────────────────────────
RSSI               → Signal Strength
MAC Address        → Device ID
OTA                → Wireless Update
Firmware           → Device Software
GPIO               → Pin Settings
PZEM-004T          → Power Sensor
Calibration        → Sensor Tuning
MQTT               → Cloud Connection
```

## 6.2 Safety for DIY

### Confirmation Levels
```
Level 1 - No confirmation:
- Toggle device ON/OFF
- Adjust brightness
- Change temperature

Level 2 - Simple confirmation:
- Delete schedule
- Disable automation
- Clear logs

Level 3 - Typed confirmation:
- Factory reset
- Firmware downgrade
- Change GPIO pins

Level 4 - Multiple confirmations:
- Bulk delete devices
- Reset all calibration
```

### Error Prevention
```
Before dangerous action:
- Clear warning icon ⚠️
- Explain consequences
- Suggest alternatives
- Require explicit confirmation

Example GPIO Change:
"⚠️ Changing GPIO pins will:
• Disconnect sensor temporarily
• Require device restart
• May break device if wrong"

[Cancel] [I understand, Continue]
```

## 6.3 Discoverability for DIY Features

### Contextual Hints
```
First time seeing technical info:
"💡 Tap the signal bars to see detailed WiFi info"

First calibration due:
"🔧 Your sensor hasn't been calibrated in 3 months. 
Tap here to learn why calibration matters."

Update available:
"📦 A new firmware version is available. 
Updates fix bugs and improve stability."
```

### Empty States with Education
```
No devices yet:
"🛠️ Start your DIY smart home journey

You'll need:
• NodeMCU ESP8266/ESP32
• Power sensor (PZEM-004T)
• Relay module

[View Hardware Guide]"

No calibration data:
"📏 Calibration improves accuracy

DIY sensors may have slight variations.
Calibrating once ensures precise readings.

[Learn More] [Calibrate Now]"
```

---

# 📱 7. RESPONSIVE CONSIDERATIONS

## 7.1 Mobile (Default)
- Single column device cards
- Bottom sheet for detailed settings
- Swipe between tabs
- Collapsible technical info

## 7.2 Tablet
- Side-by-side device list and detail
- Expanded technical graphs
- Persistent diagnostics panel
- Multi-select always visible

## 7.3 Landscape Mode
- Wide technical data tables
- Side panel for quick actions
- Expanded OTA progress view
- Split calibration wizard

---

# 🚀 8. IMPLEMENTATION NOTES

## 8.1 MQTT Topics for DIY

```
Device Status:
homesync/nodes/{node_id}/status
- online/offline
- firmware_version
- uptime
- rssi

Sensor Data:
homesync/nodes/{node_id}/sensors/power
- voltage, current, power, energy
- timestamp
- calibration_applied

Commands:
homesync/nodes/{node_id}/cmd/restart
homesync/nodes/{node_id}/cmd/ota
homesync/nodes/{node_id}/cmd/calibrate
homesync/nodes/{node_id}/cmd/reset

Config:
homesync/nodes/{node_id}/config/gpio
homesync/nodes/{node_id}/config/interval
homesync/nodes/{node_id}/config/calibration
```

## 8.2 Firmware Version Check

```
1. App reads current version from node
2. Compares with server (semver)
3. Shows update if:
   - Major version behind
   - Minor version behind > 2
   - Critical patch available
4. Changelog from GitHub releases
```

## 8.3 Offline Queue

```
Actions queued when offline:
- Toggle commands
- Calibration updates
- Config changes
- Restart commands

Sync on reconnect:
- Show pending actions count
- Execute in order
- Show results
- Retry failed actions
```

---

# 📋 APPENDIX

## A. Icon Reference (Updated)

```
DIY/Tech Icons:
  🛠️ Hardware        🔧 Settings/Tools
  💾 Firmware        🔥 Flash/OTA
  📶 Signal/WiFi     🆔 Device ID
  ⏱️ Uptime          📡 MQTT
  🔌 Plug/Node       🧰 Diagnostics
  📏 Calibration     🔄 Restart
  ⬇️ Download        ⬆️ Upload
  ⚡ Power Sensor    🎚️ Adjust

Status Icons (NEW):
  ● Online (green)
  🔴 Offline (red pulse)
  ⚠️ Warning (orange)
  📶 Signal bars (4 levels)
  📦 Firmware (box)
  🔥 Flashing (fire)
  ✅ Calibrated (check)
  📏 Needs calibration (ruler)
```

## B. Error Code Reference

```
E1001 - WiFi Connection Failed
E1002 - MQTT Connection Failed
E1003 - Sensor Read Timeout
E1004 - OTA Download Failed
E1005 - OTA Flash Failed
E1006 - Invalid Calibration
E1007 - GPIO Pin Conflict
E1008 - Low Memory Warning
E1009 - Power Supply Unstable
E1010 - Sensor Disconnected
```

## C. Calibration Formulas

```
Voltage:
Actual = (Raw + Offset) × Multiplier

Current:
Actual = (Raw + Offset) × Multiplier

Power:
Actual = Voltage_Actual × Current_Actual

Recommended initial values:
Offset: 0
Multiplier: 1.0
```

---

*Document Version: 3.0 - NodeMCU DIY Edition*  
*Last Updated: February 2026*  
*Designer: แอน (UX/UI Designer)*  
*Project: HomeSync - DIY Smart Home Control App*
